___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Billy Grace - Web Event",
  "categories": [
    "ADVERTISING",
    "ATTRIBUTION",
    "MARKETING",
    "ANALYTICS"
  ],
  "brand": {
    "id": "billygrace",
    "displayName": "Billy Grace",
    "thumbnail": "data:image/png;base64,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\u003d\u003d"
  },
  "description": "Make sure to always first fire the \"Billy Grace - Configuration Web Pixel\" tag before any web event",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "trackingID",
    "displayName": "Tracking ID",
    "simpleValueType": true,
    "notSetText": "Tracking ID needs to be set",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      },
      {
        "type": "REGEX",
        "args": [
          "^ID-([A-Za-z0-9]+-)*[A-Za-z0-9]+$"
        ]
      }
    ]
  },
  {
    "type": "RADIO",
    "name": "eventName",
    "displayName": "Event type and name",
    "radioItems": [
      {
        "value": "standard",
        "displayValue": "Standard",
        "subParams": [
          {
            "type": "SELECT",
            "name": "standardEventName",
            "displayName": "",
            "macrosInSelect": false,
            "selectItems": [
              {
                "value": "pageload",
                "displayValue": "pageload"
              },
              {
                "value": "add_to_cart",
                "displayValue": "add_to_cart"
              },
              {
                "value": "search_submitted",
                "displayValue": "search_submitted"
              },
              {
                "value": "purchase_started",
                "displayValue": "purchase_started"
              },
              {
                "value": "purchase",
                "displayValue": "purchase"
              }
            ],
            "simpleValueType": true
          }
        ],
        "help": ""
      },
      {
        "value": "custom",
        "displayValue": "Custom",
        "subParams": [
          {
            "type": "TEXT",
            "name": "customEventName",
            "displayName": "Custom event name",
            "simpleValueType": true,
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          }
        ]
      },
      {
        "value": "variable",
        "displayValue": "Variable",
        "subParams": [
          {
            "type": "SELECT",
            "name": "variableEventName",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "valueValidators": [
              {
                "type": "NON_EMPTY"
              }
            ]
          }
        ]
      }
    ],
    "simpleValueType": true
  },
  {
    "type": "GROUP",
    "name": "defaultParamsGroup",
    "displayName": "Default Parameters",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "TEXT",
        "name": "transaction_id",
        "displayName": "transaction_id",
        "simpleValueType": true
      },
      {
        "type": "TEXT",
        "name": "value",
        "displayName": "value",
        "simpleValueType": true
      },
      {
        "type": "TEXT",
        "name": "currency",
        "displayName": "currency",
        "simpleValueType": true
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "extraParamsGroup",
    "displayName": "Extra Parameters",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "extraEventParameters",
        "displayName": "",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "Name",
            "name": "eventParameterName",
            "type": "TEXT"
          },
          {
            "defaultValue": "",
            "displayName": "Value",
            "name": "eventParameterValue",
            "type": "TEXT"
          }
        ]
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "extraSettings",
    "displayName": "Extra Settings",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "TEXT",
        "name": "eventID",
        "displayName": "Event ID",
        "simpleValueType": true,
        "help": "Set the event ID field if you have setup Billy Grace tracking both on this web template as server side. This way both solutions can track the same website/app, as the event ID will be used to de-duplicate incoming events."
      },
      {
        "type": "CHECKBOX",
        "name": "isDebug",
        "checkboxText": "Debug mode",
        "simpleValueType": true,
        "help": "Will output log statements",
        "defaultValue": false
      },
      {
        "type": "CHECKBOX",
        "name": "useStaging",
        "checkboxText": "Use staging",
        "simpleValueType": true,
        "help": "Only check this box when explicitly required by Billy Grace staff"
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// GTM API functions required
const log = require('logToConsole');
const copyFromWindow = require('copyFromWindow');
const getType = require('getType');
const Object = require('Object');
const setInWindow = require('setInWindow');
const createArgumentsQueue = require('createArgumentsQueue');
const getTimestamp = require('getTimestamp');
const Math = require('Math');
const injectScript = require('injectScript');


// Debug to see if correct
if (data.isDebug){
  log('Incoming user defined: ', data);
}

// Check which option is selected and grab the right name
const getEventName = (data) => {
  // Also send unknown names, as this indicates something is wrong
  let eventName = 'unknown';
  
  // Standard events from dropdown
  if (data.eventName === 'standard' && data.standardEventName) eventName = data.standardEventName;    

  // Custom event name typed out by user
  if (data.eventName === 'custom' && data.customEventName) eventName = data.customEventName;    
  
  // GTM Variabe as event name
  if (data.eventName === 'variable' && data.variableEventName) eventName = data.variableEventName;    
  
  return eventName;
};

// If set, make sure to grab all the event data parameters and set as string
const getEventData = (data) => {
  // Store extra event data
  let customEventData = {};
  
  // If any extra custom parameters are set
  if (data.extraEventParameters){
    // If set, make sure to set in right format
    for (let extraDataItem of data.extraEventParameters) {
      customEventData[extraDataItem.eventParameterName] = extraDataItem.eventParameterValue;
    }
  }
  
  // If any of the values are set, then override anything we currently have
  if (data.transaction_id) customEventData.transaction_id = data.transaction_id;
  if (data.value) customEventData.value = data.value;
  if (data.currency) customEventData.currency = data.currency;
  
  // Used for de-duplication
  if (data.eventID) customEventData.event_id = data.eventID;
  
  // Just an empty string so no object parsing will happen on receival
  if (Object.keys(customEventData).length === 0){
     return '';
  }
  
  // Prepare data to be send out
  return customEventData;
};

// Unique identifier for BillyPix, replace 'ID-XXXXXXXX' with actual ID
const billyPixId = data.trackingID;
const cdnEndpoint = data.useStaging ? 'https://staging.bgmin.cdn.billygrace.com' : 'https://bgmin.cdn.billygrace.com';
const billyFunctionName = data.useStaging ? 'StagBillyPix' : 'BillyPix';
const eventName = getEventName(data);
const eventData = getEventData(data);



// Debug to see if correct
if (data.isDebug){
  log('eventName', eventName);
  log('eventData', eventData);
}

// Sanity check: Fail if no event name is set
if (eventName === 'unknown') {
  log('No eventName is set, please make sure to select one are set a custom one');
  return data.gtmOnFailure();
}

// Return the existing 'BillyPix' global method if available
let BillyPix = copyFromWindow(billyFunctionName);

function loadBackupBilly (BillyPixBackup) {
  // Initialize BillyPix so the Tracking ID is set on the web page
  BillyPixBackup('init', billyPixId);
  
  // Debug to see if correct
  if (data.isDebug){
    log('Backup: Successfully initialized the ' + billyFunctionName + ' for ID: ' + billyPixId);
  }
}

function loadLibraryIfNotAvailable() {
  // Function to ensure BillyPix is defined and properly queues commands
  const BillyPixBackup = createArgumentsQueue(billyFunctionName, billyFunctionName + '.queue');
  
  // Setup BillyPix with the current timestamp
  setInWindow(billyFunctionName + '.t', getTimestamp(), false);

  // Generate the script URL with cache busting
  const secondsBuste = 30*1000;
  const epochRounded = secondsBuste * Math.ceil(getTimestamp() / secondsBuste);
  const scriptUrl = cdnEndpoint + '?t=' + epochRounded + '&v=0.2.0';
  
  // Inject the BillyPix script
  injectScript(scriptUrl, loadBackupBilly(BillyPixBackup), data.gtmOnFailure, scriptUrl);
  
  return BillyPixBackup;
}


// Sanity check: BillyPix needs to be available
if (getType(BillyPix) === 'undefined') {
    
    // Make it clear they the user messed up
    log(billyFunctionName + ' not available in window, make sure to first run the "Billy Grace - Web Configuration" tag. For now we are still loading it, but this can lead to performance issued');
  
    // Load the backup when not set
    BillyPix = loadLibraryIfNotAvailable();
}

// If all is set correct, lets fire the event :)
BillyPix('event', eventName, eventData);

// Debug to see if correct
if (data.isDebug){
  log('Fired event: ', eventName, eventData);
}

data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "BillyPix"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "BillyPix.queue"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "BillyPix.t"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "StagBillyPix"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "StagBillyPix.queue"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "StagBillyPix.t"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://staging.bgmin.cdn.billygrace.com/"
              },
              {
                "type": 1,
                "string": "https://bgmin.cdn.billygrace.com/"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: purchase
  code: |-
    // Call runCode to run the template's code.
    runCode(mockDataPurchase);

    // Make sure the queue is created and BillyPix is set window as function
    assertApi('copyFromWindow').wasCalledWith('StagBillyPix');
    assertThat(StagBillyPix).isFunction();

    // Verify that the tag finished successfully.
    assertApi('gtmOnSuccess').wasCalled();
- name: no_event_name
  code: |-
    // Set to custom but keep field empty
    mockDataPageLoad.eventName = "custom";
    mockDataPageLoad.customEventName = undefined;

    // Call runCode to run the template's code.
    runCode(mockDataPageLoad);

    // Verify that the tag fails
    assertApi('gtmOnFailure').wasCalled();
- name: billypix_not_set_in_window
  code: |-
    // Make sure the function fails if the configuration tag was not ran before this tag
    // As the conifguraiton tag sets the 'BillyPix' function to be available in the window
    mock('copyFromWindow', undefined);

    // Call runCode to run the template's code.
    runCode(mockDataPageLoad);

    // Verify that the tag still runs, as it loads the backup
    assertApi('gtmOnSuccess').wasCalled();
setup: |-
  const log = require('logToConsole');
  const createArgumentsQueue = require('createArgumentsQueue');
  const getTimestamp = require('getTimestamp');

  // NOTE: This needs to be ran as the Billy Grace - Configuration pixel would have normally set this
  let StagBillyPix = createArgumentsQueue('StagBillyPix', 'StagBillyPix.queue');

  // purchase event (Standard)
  const mockDataPurchase = {
    "isDebug": false,
    "cdnBundleUrl": "https://bgmin.cdn.billygrace.com",
    "eventName": "standard",
    "standardEventName": "purchase",
    "extraEventParameters": [{
      "eventParameterName": "transaction_id",
      "eventParameterValue": "12"
    }, {
      "eventParameterName": "value",
      "eventParameterValue": "57"
    }],
    "trackingID": "ID-XX-XXXX",
    "gtmTagId": 2147483646,
    "gtmEventId": 1,
     "useStaging": true,
  };


  // pageload event (Standard)
  const mockDataPageLoad = {
    "isDebug": false,
    "cdnBundleUrl": "https://bgmin.cdn.billygrace.com",
    "eventName": "standard",
    "standardEventName": "pageload",
    "trackingID": "ID-XX-XXXX",
    "gtmTagId": 2147483646,
    "gtmEventId": 1,
    "useStaging": true,
  };


___NOTES___

Created on 25/06/2024, 17:19:11


